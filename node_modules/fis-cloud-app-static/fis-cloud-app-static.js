var fis = require('fis-cloud-kernal');

function getAppDir(appname) {
    var app = 'fis-cloud-app-' + appname;
    var path = fis.util.realpath(require.resolve(app));
    var appDir = path.substr(0, path.lastIndexOf('/') + 1);
    return appDir;
}

module.exports = function(req, res){
    var urlSplit = req.params[1].split('/');
    var appDir = getAppDir(urlSplit.shift());
    var filepath = appDir + urlSplit.join('/');
    if(fis.util.isFile(filepath)){
//        var info = fis.util.ext(filepath);
//        var contentType = fis.util.getMimeType(info.ext) || "text/plain";
//        res.writeHead(200, {
//            'Content-Type': contentType});
//         res.end();
        res.sendfile(filepath);
    }else{
        res.send(404);
    }
}
